<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script>
/* global nn */
  const filename = 'amen-break.mp3'
  let music
  const samples = {
    q: {offset: 1.7980494844900194, duration: 0.20803878332942372, color: 'red'},
    w: {offset: 2.2364169207913047, duration: 0.22289869642438287, color: 'green'},
    e: {offset: 3.5440892731476827, duration: 0.6464062196307099, color: 'pink'},
    r: {offset: 4.190495492778393, duration: 0.4235075232063261, color: 'magenta'}
  }
  

  
  async function play (e) {
    const s = samples[e.key]
    nn.get('body').css('background', s.color)
    music.currentTime = s.offset
    music.play()
    await nn.sleep(s.duration * 1000)
    music.pause()
  }
  
  // OR to mess with the music pitch
  
  async function play () {
    music.preservesPitch = false
    music.playbackRate = 2
    music.play()
  }
  
  function setup () {
    music = nn.create('audio')
    .set({
      src: filename,
      loop: true
    })
    .addTo('body')
  }
  
  nn.on('load', setup)
  nn.on('keydown', play)
  
</script>